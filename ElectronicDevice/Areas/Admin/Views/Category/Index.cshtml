@model IEnumerable<ElectronicDevice.Models.Category>
@{
    ViewBag.Title = "Thể loại sản phẩm";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
<!-- DATA TABLE -->
<h3 class="title-5 m-b-35">danh sách danh mục</h3>
<div class="table-data__tool">
    <div class="table-data__tool-left">
        <div class="rs-select2--light rs-select2--md">
            <select class="js-select2" name="status">
                <option selected="selected">Tất Cả</option>
                <option value="">Hiển Thị</option>
                <option value="">Ẩn</option>
            </select>
            <div class="dropDownSelect2"></div>
        </div>
        <button class="au-btn-filter">
            <i class="zmdi zmdi-filter-list"></i>Lọc
        </button>
    </div>
    <div class="table-data__tool-right">
        <button class="au-btn au-btn-icon au-btn--green au-btn--small" data-toggle="modal" data-target="#modal-create"
                onclick="clickAddCategory()">
            <i class="fas fa-plus"></i>Thêm mới
        </button>
    </div>
</div>
<div class="table-responsive table-data">
    <table class="table table-data2">
        <thead>
            <tr>
                <th>Icon</th>
                <th>Tên</th>
                <th>trạng thái</th>
                <th>Hành động</th>
            </tr>
        </thead>
        <tbody id="data-category">
            @foreach (var item in Model)

            {
                <tr class="tr-shadow" id="@item.ID_Category">

                    <td class="block-icon">
                        <img src="@Url.Content("~/wwwroot/imageUpload/" + item.Icon)" alt="Icon" style="max-width: 50px; max-height: 50px;" />
                    </td>
                    <td>
                        <span class="block-name-product" id="name-product">@item.Name</span>
                    </td>
                    <td>
                        <span class="status--process" id="show-status">
                            @if (item.Status)
                            {
                                <span>Hiển thị</span>
                            }
                            else
                            {
                                <span>Ẩn</span>
                            }
                        </span>
                    </td>
                    <td>
                        <div class="table-data-feature">
                            <button class="item" title="Sửa" data-toggle="modal" data-target="#modal-create"
                                    onclick="clickEditCategory(@item.ID_Category, '@item.Name', '@item.Icon',@item.Status)">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                            <button class="item" title="Xóa" onclick="deleteCategory(@item.ID_Category)">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr class="spacer" id="spacer-@item.ID_Category"></tr>
            }
        </tbody>
    </table>

</div>

<script>
    function clickAddCategory() {
        $('#mediumModalLabel').text("Thêm mới danh mục");
        $('#id').val(0);
        $('#preview').attr("src", "http://nhadephue.vn/wp-content/uploads/2021/01/icon_6.png");
        $('#Name').val("");
    }
    function clickEditCategory(idCategory, name, icon, status) {
        $('#mediumModalLabel').text("Cập nhật danh mục");
        $('#Name').val(name);

        $('#preview').attr("src", "/wwwroot/imageUpload/" + icon);
        if (status) {
            $("#show").prop("checked", true);
        } else {
            $("#hide").prop("checked", true);
        }
        $('#id').val(idCategory);
        $('#imagename').val(icon);
    }

    function deleteCategory(id) {
        let checkDelete = confirm("Xác nhậ xóa danh mục này!");
        if (checkDelete == false)
            return;

        $.ajax({
            url: '/Admin/Category/DeleteProductCategory',
            data: { id: id },
            type: "GET",
            success: (result) => {
                alert("Xóa danh mục thành công.");
                //location.reload();
                $('#' + id).remove();
                $('#spacer-' + id).remove();
            },
            error: (error) => {
                alert("Xóa danh mục thất bại!");
            }
        });
    }
</script>


@section modal{
    @Html.Partial("Create");
    @Html.Partial("Edit");
    @Html.Partial("Delete");
}